/home/paperspace/cosmos-transfer/cosmos-transfer2.5/venv/lib/python3.10/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
[11-07 05:48:21|INFO|cosmos_transfer2/_src/imaginaire/utils/checkpoint_db.py:171:path] Downloading checkpoint nvidia/Cosmos-Transfer2.5-2B/general/edge(ecd0ba00-d598-4f94-aa09-e8627899c431)
[11-07 05:48:21|INFO|cosmos_transfer2/_src/imaginaire/utils/checkpoint_db.py:96:_download] Downloading checkpoint file from Hugging Face with {'repo_id': 'nvidia/Cosmos-Transfer2.5-2B', 'repo_type': 'model', 'revision': 'bd963eabcfc2d61dc4ea365cacf41d45ac480aa5', 'filename': 'general/edge/ecd0ba00-d598-4f94-aa09-e8627899c431_ema_bf16.pt'}
[11-07 05:48:21|INFO|venv/lib/python3.10/site-packages/cosmos_oss/init.py:96:_init_log_files] Log saved to /home/paperspace/cosmos-transfer/outputs/wine_factory_princeton/console.log
[11-07 05:48:22|INFO|cosmos_transfer2/_src/imaginaire/utils/checkpoint_db.py:171:path] Downloading checkpoint nvidia/Cosmos-Guardrail1(9c7b7da4-2d95-45bb-9cb8-2eed954e9736)
[11-07 05:48:22|INFO|cosmos_transfer2/_src/imaginaire/utils/checkpoint_db.py:131:_download] Downloading checkpoint from Hugging Face with {'repo_id': 'nvidia/Cosmos-Guardrail1', 'repo_type': 'model', 'revision': 'd6d4bfa899a71454a700907664f3e88f503950cf', 'allow_patterns': ['*']}
Fetching 102 files:   0%|          | 0/102 [00:00<?, ?it/s]Fetching 102 files: 100%|██████████| 102/102 [00:00<00:00, 3320.98it/s]
/home/paperspace/cosmos-transfer/cosmos-transfer2.5/venv/lib/python3.10/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
WARNING:root:Supported flash-attn versions are >= 2.1.1, <= 2.6.3. Found flash-attn 2.8.3.
Transformer version too old, flash_attn_supports_top_left_mask is not available.
[11-07 05:48:39|INFO|cosmos_transfer2/_src/imaginaire/utils/checkpoint_db.py:171:path] Downloading checkpoint Wan2.1/vae(685afcaa-4de2-42fe-b7b9-69f7a2dee4d8)
[11-07 05:48:39|INFO|cosmos_transfer2/_src/imaginaire/utils/checkpoint_db.py:96:_download] Downloading checkpoint file from Hugging Face with {'repo_id': 'nvidia/Cosmos-Predict2.5-2B', 'repo_type': 'model', 'revision': '6787e176dce74a101d922174a95dba29fa5f0c55', 'filename': 'tokenizer.pth'}
[11-07 05:48:42|INFO|cosmos_transfer2/_src/imaginaire/utils/checkpoint_db.py:171:path] Downloading checkpoint Qwen/Qwen2.5-VL-7B-Instruct(7219c6c7-f878-4137-bbdb-76842ea85e70)
[11-07 05:48:42|INFO|cosmos_transfer2/_src/imaginaire/utils/checkpoint_db.py:131:_download] Downloading checkpoint from Hugging Face with {'repo_id': 'nvidia/Cosmos-Reason1-7B', 'repo_type': 'model', 'revision': '3210bec0495fdc7a8d3dbb8d58da5711eab4b423', 'allow_patterns': ['*']}
Fetching 13 files:   0%|          | 0/13 [00:00<?, ?it/s]Fetching 13 files: 100%|██████████| 13/13 [00:00<00:00, 6993.20it/s]
[11-07 05:48:43|INFO|cosmos_transfer2/_src/imaginaire/utils/checkpoint_db.py:171:path] Downloading checkpoint nvidia/Cosmos-Reason1.1-7B(cb3e3ffa-7b08-4c34-822d-61c7aa31a14f)
[11-07 05:48:43|INFO|cosmos_transfer2/_src/imaginaire/utils/checkpoint_db.py:131:_download] Downloading checkpoint from Hugging Face with {'repo_id': 'nvidia/Cosmos-Reason1-7B', 'repo_type': 'model', 'revision': '3210bec0495fdc7a8d3dbb8d58da5711eab4b423', 'allow_patterns': ['*']}
Fetching 13 files:   0%|          | 0/13 [00:00<?, ?it/s]Fetching 13 files: 100%|██████████| 13/13 [00:00<00:00, 20899.18it/s]
[11-07 05:49:18|INFO|cosmos_transfer2/inference.py:98:__init__] Found 1 hint keys across all samples
WARNING:cosmos_transfer2._src.imaginaire.lazy_config.lazy:Config is saved using omegaconf at /home/paperspace/cosmos-transfer/outputs/wine_factory_princeton/config.yaml.
[11-07 05:49:18|INFO|cosmos_transfer2/inference.py:108:__init__] Saved config to /home/paperspace/cosmos-transfer/outputs/wine_factory_princeton/config.yaml
[11-07 05:49:18|INFO|cosmos_transfer2/inference.py:113:generate] Generating 1 samples: ['wine_factory_princeton']
[11-07 05:49:18|INFO|cosmos_transfer2/inference.py:117:generate] [1/1] Processing sample wine_factory_princeton
[11-07 05:49:18|INFO|cosmos_transfer2/inference.py:145:_generate_sample] Saved arguments to /home/paperspace/cosmos-transfer/outputs/wine_factory_princeton/wine_factory_princeton.json
[11-07 05:49:18|INFO|cosmos_transfer2/inference.py:149:_generate_sample] Running guardrail check on prompt...
[11-07 05:49:22|SUCCESS|cosmos_transfer2/inference.py:159:_generate_sample] Passed guardrail on prompt
[11-07 05:49:24|SUCCESS|cosmos_transfer2/inference.py:172:_generate_sample] Passed guardrail on negative prompt
[11-07 05:49:24|INFO|cosmos_transfer2/inference.py:177:_generate_sample] Processing the following paths: {'edge': None, 'edge_mask': None, 'edge_mask_prompt': None}
Generating samples:   0%|          | 0/35 [00:00<?, ?it/s]Generating samples:   3%|▎         | 1/35 [00:08<04:51,  8.57s/it]Generating samples:   6%|▌         | 2/35 [00:16<04:27,  8.09s/it]Generating samples:   9%|▊         | 3/35 [00:24<04:14,  7.94s/it]Generating samples:  11%|█▏        | 4/35 [00:31<04:03,  7.87s/it]Generating samples:  14%|█▍        | 5/35 [00:39<03:54,  7.83s/it]Generating samples:  17%|█▋        | 6/35 [00:47<03:46,  7.81s/it]Generating samples:  20%|██        | 7/35 [00:55<03:38,  7.79s/it]Generating samples:  23%|██▎       | 8/35 [01:02<03:30,  7.78s/it]Generating samples:  26%|██▌       | 9/35 [01:10<03:22,  7.78s/it]Generating samples:  29%|██▊       | 10/35 [01:18<03:14,  7.78s/it]Generating samples:  31%|███▏      | 11/35 [01:26<03:06,  7.78s/it]Generating samples:  34%|███▍      | 12/35 [01:33<02:58,  7.77s/it]Generating samples:  37%|███▋      | 13/35 [01:41<02:51,  7.77s/it]Generating samples:  40%|████      | 14/35 [01:49<02:43,  7.77s/it]Generating samples:  43%|████▎     | 15/35 [01:57<02:35,  7.77s/it]Generating samples:  46%|████▌     | 16/35 [02:05<02:27,  7.77s/it]Generating samples:  49%|████▊     | 17/35 [02:12<02:19,  7.77s/it]Generating samples:  51%|█████▏    | 18/35 [02:20<02:12,  7.77s/it]Generating samples:  54%|█████▍    | 19/35 [02:28<02:04,  7.77s/it]Generating samples:  57%|█████▋    | 20/35 [02:36<01:56,  7.77s/it]Generating samples:  60%|██████    | 21/35 [02:43<01:48,  7.77s/it]Generating samples:  63%|██████▎   | 22/35 [02:51<01:40,  7.76s/it]Generating samples:  66%|██████▌   | 23/35 [02:59<01:33,  7.76s/it]Generating samples:  69%|██████▊   | 24/35 [03:07<01:25,  7.76s/it]Generating samples:  71%|███████▏  | 25/35 [03:14<01:17,  7.76s/it]Generating samples:  74%|███████▍  | 26/35 [03:22<01:09,  7.76s/it]Generating samples:  77%|███████▋  | 27/35 [03:30<01:02,  7.76s/it]Generating samples:  80%|████████  | 28/35 [03:38<00:54,  7.76s/it]Generating samples:  83%|████████▎ | 29/35 [03:45<00:46,  7.76s/it]Generating samples:  86%|████████▌ | 30/35 [03:53<00:38,  7.76s/it]Generating samples:  89%|████████▊ | 31/35 [04:01<00:31,  7.76s/it]Generating samples:  91%|█████████▏| 32/35 [04:09<00:23,  7.76s/it]Generating samples:  94%|█████████▍| 33/35 [04:17<00:15,  7.76s/it]Generating samples:  97%|█████████▋| 34/35 [04:24<00:07,  7.76s/it]Generating samples: 100%|██████████| 35/35 [04:32<00:00,  7.76s/it]Generating samples: 100%|██████████| 35/35 [04:32<00:00,  7.79s/it]
Generating samples:   0%|          | 0/35 [00:00<?, ?it/s]Generating samples:   3%|▎         | 1/35 [00:07<04:23,  7.76s/it]Generating samples:   6%|▌         | 2/35 [00:15<04:16,  7.76s/it]Generating samples:   9%|▊         | 3/35 [00:23<04:08,  7.76s/it]Generating samples:  11%|█▏        | 4/35 [00:31<04:00,  7.76s/it]Generating samples:  14%|█▍        | 5/35 [00:38<03:52,  7.76s/it]Generating samples:  17%|█▋        | 6/35 [00:46<03:45,  7.76s/it]Generating samples:  20%|██        | 7/35 [00:54<03:37,  7.76s/it]Generating samples:  23%|██▎       | 8/35 [01:02<03:29,  7.76s/it]Generating samples:  26%|██▌       | 9/35 [01:09<03:21,  7.76s/it]Generating samples:  29%|██▊       | 10/35 [01:17<03:13,  7.76s/it]Generating samples:  31%|███▏      | 11/35 [01:25<03:06,  7.76s/it]Generating samples:  34%|███▍      | 12/35 [01:33<02:58,  7.76s/it]Generating samples:  37%|███▋      | 13/35 [01:40<02:50,  7.76s/it]Generating samples:  40%|████      | 14/35 [01:48<02:42,  7.76s/it]Generating samples:  43%|████▎     | 15/35 [01:56<02:35,  7.76s/it]Generating samples:  46%|████▌     | 16/35 [02:04<02:27,  7.76s/it]Generating samples:  49%|████▊     | 17/35 [02:11<02:19,  7.76s/it]Generating samples:  51%|█████▏    | 18/35 [02:19<02:11,  7.76s/it]Generating samples:  54%|█████▍    | 19/35 [02:27<02:04,  7.76s/it]Generating samples:  57%|█████▋    | 20/35 [02:35<01:56,  7.76s/it]Generating samples:  60%|██████    | 21/35 [02:42<01:48,  7.76s/it]Generating samples:  63%|██████▎   | 22/35 [02:50<01:40,  7.76s/it]Generating samples:  66%|██████▌   | 23/35 [02:58<01:33,  7.76s/it]Generating samples:  69%|██████▊   | 24/35 [03:06<01:25,  7.76s/it]Generating samples:  71%|███████▏  | 25/35 [03:14<01:17,  7.76s/it]Generating samples:  74%|███████▍  | 26/35 [03:21<01:09,  7.76s/it]Generating samples:  77%|███████▋  | 27/35 [03:29<01:02,  7.76s/it]Generating samples:  80%|████████  | 28/35 [03:37<00:54,  7.76s/it]Generating samples:  83%|████████▎ | 29/35 [03:45<00:46,  7.76s/it]Generating samples:  86%|████████▌ | 30/35 [03:52<00:38,  7.76s/it]Generating samples:  89%|████████▊ | 31/35 [04:00<00:31,  7.76s/it]Generating samples:  91%|█████████▏| 32/35 [04:08<00:23,  7.76s/it]Generating samples:  94%|█████████▍| 33/35 [04:16<00:15,  7.76s/it]Generating samples:  97%|█████████▋| 34/35 [04:23<00:07,  7.76s/it]Generating samples: 100%|██████████| 35/35 [04:31<00:00,  7.75s/it]Generating samples: 100%|██████████| 35/35 [04:31<00:00,  7.76s/it]
Generating samples:   0%|          | 0/35 [00:00<?, ?it/s]Generating samples:   3%|▎         | 1/35 [00:07<04:24,  7.77s/it]Generating samples:   6%|▌         | 2/35 [00:15<04:16,  7.76s/it]Generating samples:   9%|▊         | 3/35 [00:23<04:08,  7.76s/it]Generating samples:  11%|█▏        | 4/35 [00:31<04:00,  7.76s/it]Generating samples:  14%|█▍        | 5/35 [00:38<03:52,  7.76s/it]Generating samples:  17%|█▋        | 6/35 [00:46<03:45,  7.76s/it]Generating samples:  20%|██        | 7/35 [00:54<03:37,  7.76s/it]Generating samples:  23%|██▎       | 8/35 [01:02<03:29,  7.76s/it]Generating samples:  26%|██▌       | 9/35 [01:09<03:21,  7.76s/it]Generating samples:  29%|██▊       | 10/35 [01:17<03:13,  7.76s/it]Generating samples:  31%|███▏      | 11/35 [01:25<03:06,  7.76s/it]Generating samples:  34%|███▍      | 12/35 [01:33<02:58,  7.76s/it]Generating samples:  37%|███▋      | 13/35 [01:40<02:50,  7.76s/it]Generating samples:  40%|████      | 14/35 [01:48<02:42,  7.76s/it]Generating samples:  43%|████▎     | 15/35 [01:56<02:35,  7.76s/it]Generating samples:  46%|████▌     | 16/35 [02:04<02:27,  7.76s/it]Generating samples:  49%|████▊     | 17/35 [02:11<02:19,  7.76s/it]Generating samples:  51%|█████▏    | 18/35 [02:19<02:11,  7.76s/it]Generating samples:  54%|█████▍    | 19/35 [02:27<02:04,  7.76s/it]Generating samples:  57%|█████▋    | 20/35 [02:35<01:56,  7.76s/it]Generating samples:  60%|██████    | 21/35 [02:42<01:48,  7.76s/it]Generating samples:  63%|██████▎   | 22/35 [02:50<01:40,  7.76s/it]Generating samples:  66%|██████▌   | 23/35 [02:58<01:33,  7.76s/it]Generating samples:  69%|██████▊   | 24/35 [03:06<01:25,  7.76s/it]Generating samples:  71%|███████▏  | 25/35 [03:13<01:17,  7.76s/it]Generating samples:  74%|███████▍  | 26/35 [03:21<01:09,  7.76s/it]Generating samples:  77%|███████▋  | 27/35 [03:29<01:02,  7.76s/it]Generating samples:  80%|████████  | 28/35 [03:37<00:54,  7.76s/it]Generating samples:  83%|████████▎ | 29/35 [03:45<00:46,  7.76s/it]Generating samples:  86%|████████▌ | 30/35 [03:52<00:38,  7.76s/it]Generating samples:  89%|████████▊ | 31/35 [04:00<00:31,  7.76s/it]Generating samples:  91%|█████████▏| 32/35 [04:08<00:23,  7.76s/it]Generating samples:  94%|█████████▍| 33/35 [04:16<00:15,  7.76s/it]Generating samples:  97%|█████████▋| 34/35 [04:23<00:07,  7.76s/it]Generating samples: 100%|██████████| 35/35 [04:31<00:00,  7.75s/it]Generating samples: 100%|██████████| 35/35 [04:31<00:00,  7.76s/it]
Generating samples:   0%|          | 0/35 [00:00<?, ?it/s]Generating samples:   3%|▎         | 1/35 [00:07<04:25,  7.80s/it]Generating samples:   6%|▌         | 2/35 [00:15<04:17,  7.80s/it]Generating samples:   9%|▊         | 3/35 [00:23<04:09,  7.80s/it]Generating samples:  11%|█▏        | 4/35 [00:31<04:01,  7.79s/it]Generating samples:  14%|█▍        | 5/35 [00:38<03:53,  7.78s/it]Generating samples:  17%|█▋        | 6/35 [00:46<03:45,  7.77s/it]Generating samples:  20%|██        | 7/35 [00:54<03:37,  7.77s/it]Generating samples:  23%|██▎       | 8/35 [01:02<03:29,  7.77s/it]Generating samples:  26%|██▌       | 9/35 [01:09<03:21,  7.76s/it]Generating samples:  29%|██▊       | 10/35 [01:17<03:14,  7.76s/it]Generating samples:  31%|███▏      | 11/35 [01:25<03:06,  7.76s/it]Generating samples:  34%|███▍      | 12/35 [01:33<02:58,  7.76s/it]Generating samples:  37%|███▋      | 13/35 [01:41<02:50,  7.76s/it]Generating samples:  40%|████      | 14/35 [01:48<02:42,  7.76s/it]Generating samples:  43%|████▎     | 15/35 [01:56<02:35,  7.76s/it]Generating samples:  46%|████▌     | 16/35 [02:04<02:27,  7.76s/it]Generating samples:  49%|████▊     | 17/35 [02:12<02:19,  7.76s/it]Generating samples:  51%|█████▏    | 18/35 [02:19<02:11,  7.76s/it]Generating samples:  54%|█████▍    | 19/35 [02:27<02:04,  7.76s/it]Generating samples:  57%|█████▋    | 20/35 [02:35<01:56,  7.76s/it]Generating samples:  60%|██████    | 21/35 [02:43<01:48,  7.76s/it]Generating samples:  63%|██████▎   | 22/35 [02:50<01:40,  7.76s/it]Generating samples:  66%|██████▌   | 23/35 [02:58<01:33,  7.76s/it]Generating samples:  69%|██████▊   | 24/35 [03:06<01:25,  7.76s/it]Generating samples:  71%|███████▏  | 25/35 [03:14<01:17,  7.76s/it]Generating samples:  74%|███████▍  | 26/35 [03:21<01:09,  7.76s/it]Generating samples:  77%|███████▋  | 27/35 [03:29<01:02,  7.76s/it]Generating samples:  80%|████████  | 28/35 [03:37<00:54,  7.76s/it]Generating samples:  83%|████████▎ | 29/35 [03:45<00:46,  7.76s/it]Generating samples:  86%|████████▌ | 30/35 [03:52<00:38,  7.76s/it]Generating samples:  89%|████████▊ | 31/35 [04:00<00:31,  7.76s/it]Generating samples:  91%|█████████▏| 32/35 [04:08<00:23,  7.76s/it]Generating samples:  94%|█████████▍| 33/35 [04:16<00:15,  7.76s/it]Generating samples:  97%|█████████▋| 34/35 [04:23<00:07,  7.76s/it]Generating samples: 100%|██████████| 35/35 [04:31<00:00,  7.75s/it]Generating samples: 100%|██████████| 35/35 [04:31<00:00,  7.76s/it]
Generating samples:   0%|          | 0/35 [00:00<?, ?it/s]Generating samples:   3%|▎         | 1/35 [00:07<04:23,  7.76s/it]Generating samples:   6%|▌         | 2/35 [00:15<04:16,  7.76s/it]Generating samples:   9%|▊         | 3/35 [00:23<04:08,  7.76s/it]Generating samples:  11%|█▏        | 4/35 [00:31<04:00,  7.76s/it]Generating samples:  14%|█▍        | 5/35 [00:38<03:52,  7.76s/it]Generating samples:  17%|█▋        | 6/35 [00:46<03:45,  7.76s/it]Generating samples:  20%|██        | 7/35 [00:54<03:37,  7.76s/it]Generating samples:  23%|██▎       | 8/35 [01:02<03:29,  7.76s/it]Generating samples:  26%|██▌       | 9/35 [01:09<03:21,  7.76s/it]Generating samples:  29%|██▊       | 10/35 [01:17<03:13,  7.76s/it]Generating samples:  31%|███▏      | 11/35 [01:25<03:06,  7.76s/it]Generating samples:  34%|███▍      | 12/35 [01:33<02:58,  7.76s/it]Generating samples:  37%|███▋      | 13/35 [01:40<02:50,  7.76s/it]Generating samples:  40%|████      | 14/35 [01:48<02:42,  7.76s/it]Generating samples:  43%|████▎     | 15/35 [01:56<02:35,  7.76s/it]Generating samples:  46%|████▌     | 16/35 [02:04<02:27,  7.76s/it]Generating samples:  49%|████▊     | 17/35 [02:11<02:19,  7.76s/it]Generating samples:  51%|█████▏    | 18/35 [02:19<02:11,  7.76s/it]Generating samples:  54%|█████▍    | 19/35 [02:27<02:04,  7.76s/it]Generating samples:  57%|█████▋    | 20/35 [02:35<01:56,  7.76s/it]Generating samples:  60%|██████    | 21/35 [02:42<01:48,  7.76s/it]Generating samples:  63%|██████▎   | 22/35 [02:50<01:40,  7.76s/it]Generating samples:  66%|██████▌   | 23/35 [02:58<01:33,  7.76s/it]Generating samples:  69%|██████▊   | 24/35 [03:06<01:25,  7.76s/it]Generating samples:  71%|███████▏  | 25/35 [03:13<01:17,  7.76s/it]Generating samples:  74%|███████▍  | 26/35 [03:21<01:09,  7.76s/it]Generating samples:  77%|███████▋  | 27/35 [03:29<01:02,  7.76s/it]Generating samples:  80%|████████  | 28/35 [03:37<00:54,  7.76s/it]Generating samples:  83%|████████▎ | 29/35 [03:45<00:46,  7.76s/it]Generating samples:  86%|████████▌ | 30/35 [03:52<00:38,  7.76s/it]Generating samples:  89%|████████▊ | 31/35 [04:00<00:31,  7.76s/it]Generating samples:  91%|█████████▏| 32/35 [04:08<00:23,  7.76s/it]Generating samples:  94%|█████████▍| 33/35 [04:16<00:15,  7.75s/it]Generating samples:  97%|█████████▋| 34/35 [04:23<00:07,  7.75s/it]Generating samples: 100%|██████████| 35/35 [04:31<00:00,  7.75s/it]Generating samples: 100%|██████████| 35/35 [04:31<00:00,  7.76s/it]
[11-07 06:13:53|INFO|cosmos_transfer2/inference.py:231:_generate_sample] edge control video saved to /home/paperspace/cosmos-transfer/outputs/wine_factory_princeton/wine_factory_princeton_control_edge.mp4
[11-07 06:13:53|INFO|cosmos_transfer2/inference.py:235:_generate_sample] Running guardrail check on video...
[11-07 06:14:28|SUCCESS|cosmos_transfer2/inference.py:245:_generate_sample] Passed guardrail on generated video
[11-07 06:14:47|SUCCESS|cosmos_transfer2/inference.py:259:_generate_sample] Generated video saved to /home/paperspace/cosmos-transfer/outputs/wine_factory_princeton/wine_factory_princeton.mp4
